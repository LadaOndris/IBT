from src.datasets.bighand.dataset import BighandDataset
from src.pose_estimation.dataset_generator import DatasetGenerator
from src.pose_estimation.jgr_j2o import JGR_J2O
from src.utils.paths import BIGHAND_DATASET_DIR
import numpy as np
import matplotlib.pyplot as plt


vals = """
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 1.17702448e-04
 1.17702448e-04 1.17702448e-04 4.70809793e-04 1.41242938e-03
 3.29566855e-03 6.12052731e-03 1.18879473e-02 2.08333333e-02
 3.23681733e-02 5.29661017e-02 7.49764595e-02 1.01930320e-01
 1.30061205e-01 1.64665725e-01 1.95739171e-01 2.29519774e-01
 2.63064972e-01 3.04143126e-01 3.47222222e-01 3.88418079e-01
 4.26671375e-01 4.68808851e-01 5.08121469e-01 5.45080038e-01
 5.81214689e-01 6.11817326e-01 6.40065913e-01 6.64665725e-01
 6.87853107e-01 7.11040490e-01 7.36111111e-01 7.55649718e-01
 7.73893597e-01 7.89194915e-01 8.02966102e-01 8.14147834e-01
 8.26859699e-01 8.37452919e-01 8.48399247e-01 8.60640301e-01
 8.72057439e-01 8.81002825e-01 8.89595104e-01 8.98305085e-01
 9.06544256e-01 9.15136535e-01 9.20668550e-01 9.26082863e-01
 9.32321092e-01 9.36676083e-01 9.42208098e-01 9.46680791e-01
 9.51271186e-01 9.54331450e-01 9.58804143e-01 9.63983051e-01
 9.66219397e-01 9.69750471e-01 9.71986817e-01 9.74223164e-01
 9.76224105e-01 9.78695857e-01 9.80932203e-01 9.82344633e-01
 9.83992467e-01 9.85993409e-01 9.87405838e-01 9.88818267e-01
 9.89524482e-01 9.90348399e-01 9.91172316e-01 9.91643126e-01
 9.92113936e-01 9.92702448e-01 9.93290960e-01 9.93526365e-01
 9.93879473e-01 9.94585687e-01 9.95056497e-01 9.95645009e-01
 9.96115819e-01 9.96233522e-01 9.96939736e-01 9.97175141e-01
 9.97881356e-01 9.97999058e-01 9.98352166e-01 9.98705273e-01
 9.98705273e-01 9.98940678e-01 9.99058380e-01 9.99293785e-01
 9.99293785e-01 9.99529190e-01 9.99529190e-01 9.99529190e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99646893e-01 9.99646893e-01 9.99646893e-01
 9.99646893e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99764595e-01 9.99764595e-01 9.99764595e-01 9.99764595e-01
 9.99882298e-01 9.99882298e-01 9.99882298e-01 9.99882298e-01
 """

proportions = np.fromstring(vals, sep=' ')

fig, ax = plt.subplots()
ax.plot(proportions[:120])
fig.show()


def evaluate():
    # load model!
    network = JGR_J2O()
    model = network.graph()

    # initialize dataset
    im_out_size = 24
    bighand_ds = BighandDataset(BIGHAND_DATASET_DIR, train_size=0.9, batch_size=1, shuffle=False)
    gen = DatasetGenerator(iter(bighand_ds.test_dataset), im_out_size)

    for batch in gen:
        images, y_true = batch
        model.predict()
